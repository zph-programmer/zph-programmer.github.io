# 项目开发流程规范

转载于[xinliangnote (新亮笔记) (github.com)](https://github.com/xinliangnote)

一次完整项目的发布说起，一次完整项目的发布，大概需要经过这几个大的节点：

项目立项 -> 需求评审 -> 视觉稿评审 -> 技术评审 -> 项目启动 -> 开发 -> 联调 -> 测试 -> 发布。

有句话是这么说的，通过控制过程质量，来保证结果质量。

## 制定规范

#### 技术评审规范

在技术评审前要熟悉产品同学提供的 `产品文档`、 `业务流程图`、 `交互原型图`，反复与产品同学确认，在双方达成一致的情况下，再设计技术方案。

设计技术方案要从 总体 到 局部 ，做到面面俱到。

**总体：**

- 总体结构图
- 业务流程图
- 时序图
- 核心类图

**局部：**

- 功能的变更
- 数据库字段的变更
- 业务流程上的变更
- 上下游接口约定的变更

**当技术方案确定了，我们就确定了：**

- 技术选型（前端/后端框架、日志中间件、消息中间件、数据库...）
- 技术架构（组件与组件之间如何协同工作，如何部署）
- 技术难点预知（明确存在的技术难点，并确定解决方案）
- 性能瓶颈预知（明确可能存在性能瓶颈的地方，并确定应对措施）
- 上下游系统交互（明确在流程中的哪个位置，约定接口文档提供时间、接口联调时间）
- 功能模块划分（任务拆分和分配）

**当技术方案确定了，需要输出文档：**

- **预估开发工期.xlsx**，包括 `系统`、 `模块`、 `功能`、 `功能简述`、 `研发人员`、 `工时(h)`、 `预计完成时间` 等。

  功能除了包括正常的开发工作，还要包括 `提供接口文档`， `接口联调`， `研发自测`， `文档更新` 等。

  正常的功能开发，拆分成工时的颗粒度最大为 2h，这样的颗粒度能够降低工作的复杂度，使不熟悉相关业务的研发也能够快速上手，比如 2h 就写一个方法。

- **更新项目文档**，包括 `项目介绍`、 `产品文档`、 `业务流程`、 `系统结构`、 `接口文档`、 `数据字段`、 `外部依赖`、 `其他` 等。

这个分类可自定义，主要是为了解决 当人员发生流动 导致 系统交接时产生遗漏的问题。

#### 代码风格规范

虽然代码风格并不影响程序的运行，也不会给程序带来潜在的危险，但是一段好的代码风格，阅读起来能让人赏心悦目，特别是阅读别人的代码，就像自己写的一样。

根据自己使用的语言，制定代码风格规范，可参考语言的相关标准，比如 `PHP` 有 `PSR` 。

代码风格规范达成一致后，一定要落实到文档上！

方便其他同事进行 CodeReview 时使用。

#### 代码开发规范

- 接入 统一可视化日志 平台。
- 接入 统一配置中心 平台。
- 接入 统一异常监控 平台。
- 接入 统一消息中间件 平台。
- 异常处理规范：直接返回、抛出异常、重试处理、熔断处理、降级处理。
- 统一 API 规范：HTTP 接口、RPC 接口，Code、Msg、Data 等。
- 分支开发规范：分支名称规范、热修复规范、上线规范 等。
- 其他规范，大家可以自行补充 ...

#### 代码管理规范

常用的代码管理工具：`Git`、 `SVN`。

工具的使用，大家都知道，就不多说了，约定一些基础的规范。

- 不要提交自己的用户配置，比如 IDE 配置。
- 不要提交不能通过编译的代码。
- 要早提交、常提交，提交之前要先更新。
- 提交信息一定要认真填写，参考Git-commit-message规范。

#### CodeReview 规范

**CodeReview 检查哪些问题？**

- 规范性检查

- - 是否遵循代码开发风格规范、代码开发规范。
  - 是否所有的变量都被正确定义和使用，注释是否准确。

- 健壮性检查

- - 是否无意中陷入了死循环。
  - 是否存在异常未处理、资源未释放的情况。
  - 是否存在运行时错误（数组边界溢出、除以零的情况）。

- 重用性检查

- - 是否存在相同的方法写了两次，是否可以写成通用类、方法、组件等。

- 安全性检查

- - 是否存在 SQL注入、XSS、SSRF、CSRF、越权、文件上传 等漏洞。

- 性能检查

- - 是否存在同步执行太慢，需要转成异步执行的情况。
  - 是否存在未加缓存，频繁链接 DB 的情况。
  - 是否需要使用连接池。



**CodeReview 如何执行？**

- 前期准备

- - 制定 CodeReview 规范和标准，这样在审查过程中可以有据可依，有理可循。
  - 确定 CodeReview 审查者、参与者。

- 实施期

- - 在 CodeReview 前，审查者需将 审查内容 及 审查的规范和标准 告知所有参与者和代码作者。
  - 在 CodeReview 时，审查者要进行逐项审查，不能因为时间不足等因素一扫而过。
  - 在 CodeReview 后，审查者要对发现的问题，给予解决方案，同时进行问题记录，便于事后跟踪。
  - 审查者不能只在发现问题时提问，遇到不清楚的代码设计和业务，也可以让代码作者进行讲解，便于自己熟悉整个业务和代码设计。
  - 期间营造一个讨论问题、解决问题的氛围，不能搞成批判会，这样会影响大家的积极性。

- 事后跟踪

- - 对发现的问题，确定修复的难易程度以及影响的范围。

  - 对发现的问题，确定修复完成的时间点。

  - 对发现的问题，修复后要进行验证。

    

开发流程规范，目的是提高产品质量，优化开发流程，供大家参考。

规范是死的，人是活的，希望自己定的规范，不要被打脸。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/go9jpG3BuhT7YjfeLhn7Hp5qcveQuIzAI6AXicAkePcib4WnfLBqF0QIaDDnCJrLhbtJjCATNl1pQe4nPSz7YmRw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

接下来从以上六个阶段进行逐一拆解。

## 1 需求评审

作为技术人员肯定都参加过需求评审会，不知道有没有遇到这样的情况？

- 产品经理按照 PRD 文档读一遍，参会人员无动于衷。
- 产品经理刚讲了一个需求点，参会人员就产生了激烈的讨论，都在证明自己是对的。
- 参会人员对需求的目标不明确，对需求点进行发散思维讨论，最终偏离方向。

遇到以上问题，肯定是在参加需求评审之前未做充分准备，那么问题来了，需要提前准备什么？

#### 评审前

不要听产品同学说，该需求是大老板跟进的、非常重要、非常紧急之类的，就问产品三个问题：

1. 解决了什么问题？
2. 提升了什么指标？
3. 有什么商业价值？

这三个问题搞清楚了，再进行评审。

产品经理发出 `原型` 和 `PRD` 初稿后，开发人员要有 `1-2` 天时间（具体时间根据项目大小而定），熟悉文档，有任何疑问可以反馈给开发经理，由开发经理统一收集再反馈给产品经理，产品经理逐一进行答疑。

熟悉完文档后，开发人员和开发经理需要一起确定：

- 技术选型（前端/后端框架、日志中间件、消息中间件、数据库...）
- 技术架构（组件与组件之间如何协同工作，如何部署）
- 技术难点预知（明确存在的技术难点，并确定解决方案）
- 性能瓶颈预知（明确可能存在性能瓶颈的地方，并确定应对措施）
- 上下游系统交互（明确在流程中的哪个位置，约定接口文档提供时间、接口联调时间）
- 功能模块划分（任务拆分和分配）

技术方案确定后，需要输出技术设计文档，包括：`总体设计`、`概要设计`、`详细设计`、`接口设计` 等。

#### 评审中

开发人员必须参加，有需求不明确的地方当场提出，同时开发人员也需要思考产品需求是否合理，可适当提出自己的产品意见。

一般评审至少有两次（初稿和终稿）。

#### 评审后

评审后，如有需更新技术文档的请及时进行更新。

开发经理首先需要考虑团队现有的资源及项目的优先级，然后根据技术设计文档进行评估排期。

排期模板如下：

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/go9jpG3BuhT7YjfeLhn7Hp5qcveQuIzATurJ3kpbFTZamlOBndicB5FGmSJ2VEBa65S7Id79ELhiaTUn0gpaDyXQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

## 2 技术评审

#### 评审前

开发人员一定要重视技术设计！

开发人员一定要重视技术设计！

开发人员一定要重视技术设计！

重要事情说三遍！

技术评审主要评审什么？

- `系统关系图`、`模块关系图`、`流程图的设计`，画图工具根据自己爱好即可。
- `接口设计`，需要考虑接口的 兼容性、扩展性、参数命名遵守 **参数命名规范** 等。
- `数据库设计`，需要遵守 **数据库设计规范**，并记录 **数据表变更文档**。
- `详细设计`，需要考虑公共类、公共方法、方法定义 遵守 **项目框架目录规范**。

#### 评审中

开发人员和开发经理必须参加，涉及到总体设计和概要设计时，需要邀请 **架构师** 参与，涉及到数据库调整时，需要邀请 **DBA** 参与。

一般评审至少有两次（初稿和终稿）。

#### 评审后

评审后，如有需更新排期文档的请及时进行更新。

排期确定后，通过邮件方式进行回复排期，使用标准化的 **回复排期邮件模板**。

按部就班，按计划行事。

## 3 需求开发

#### 编码

开发人员编码过程中，需要遵守团队的 **编码规范**，同时严格按照设计文档中的技术方案执行，除了保证代码逻辑的正确性外，还需要考虑代码`封装性`、`可维护性`、`可扩展性`，当编码阶段发现技术方案需要调整时，需要及时通知开发经理，经过同意后才能实施，涉及到引入新框架和新技术，也需要提前通知开发经理。

#### 代码审查

开发人员需要控制代码提交的频次和粒度，每次代码提交之后 24 小时内，需要主动联系代码审查人完成检查，开发经理负责检查是否执行到位。

代码审查主要审查什么？

- 规范性检查（是否符合代码规范、提交备注规范等）
- 健壮性检查（是否陷入死循环、资源未释放等）
- 安全性检查（是否存在SQL注入、XSS、SSRF、CSRF、越权、文件上传等）
- 性能检查（是否存在未加缓存频繁连接DB，是否需要连接池）

#### 联调

开发人员积极主动地推动联调工作，如果遇到阻碍及时通知技术经理进行协调。

#### 自测

联调完毕后，开发人员需要同时完成自测，并将标准化的 **自测报告** 发给测试团队。

对于有性能要求的项目，需要开发人员进行性能测试，并出具标准化的 **性能测试报告**。

#### 提测

自测完毕后，通过邮件方式进行提测申请，使用标准化的 **申请提测邮件模板**。

开发人员根据公司运维提供的发布方式，进行部署到测试环境。

## 4 跟进测试

#### 测试用例评审

开发人员必须参加，避免出现测试与开发对需求理解不一致的情况。

#### Bug 修复

开发人员及时关注 Bug 列表，快速修复迭代发布，如果测试进度存在延期风险，需要及时通知开发经理。

## 5 跟进上线

开发人员首先确认 Bug 全部关闭，同时产品人员在测试环境验收通过，然后需要主动推动相关团队理清上线依赖和上线顺序，同时确定回滚预案，最后根据公司运维提供的发布方式，进行部署到线上环境。

线上环境部署完成后，通过邮件方式进行通知产品人员和测试人员，使用标准化的 **上线完毕邮件模板**，同时积极推动测试人员和产品人员完成线上验证，线上出现问题后第一时间通知开发经理。

## 6 线上问题复盘

需求在测试环境和正式环境，均未测试出 Bug，上线一段时候后出现 Bug，这种问题用什么制度约束？

出现问题后开发人员及时修复，修复完了就完事了。仅仅做到这些还远远不够。

建议使用如下模板进行复盘。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/go9jpG3BuhT7YjfeLhn7Hp5qcveQuIzAy1z8BYQN6iaHNgDnbOMicmicHOV4dRQOwCtwp5L1s2f2UDAwNbibmrGjRA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

## 小结

大家可以数一数上面使用到了多少规范，这时有朋友会说了，这规范也太多了吧，这和工厂工人有什么区别，我们程序员是有创造性的，我们喜欢前沿性、挑战性的工作，我们放荡不羁爱自由...

针对这个问题，首先我不否认开发人员是有创造性的，但并不是所有的程序员都有创造性，在现实工作场景中大部分程序员不是做创造性工作的，也没必要做创造性工作，所以必须按照规范流程执行。

团队管理和团队之间合作，必须要有规范，并严格执行。